{"version":3,"file":"ej2-querybuilder.min.js","sources":["../../src/query-builder/query-builder.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/**\n * Query Builder Source\n */\nimport { Component, NotifyPropertyChanges, getComponent, Browser } from '@syncfusion/ej2-base';\nimport { Property, ChildProperty, Complex, L10n, closest, extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getInstance, addClass, removeClass, rippleEffect, detach, classList } from '@syncfusion/ej2-base';\nimport { Internationalization } from '@syncfusion/ej2-base';\nimport { Button, RadioButton } from '@syncfusion/ej2-buttons';\nimport { DropDownList, CheckBoxSelection } from '@syncfusion/ej2-dropdowns';\nimport { MultiSelect } from '@syncfusion/ej2-dropdowns';\nimport { Event, EventHandler, getValue, Animation } from '@syncfusion/ej2-base';\nimport { Query, Predicate, DataManager, Deferred } from '@syncfusion/ej2-data';\nimport { TextBox, NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { DatePicker } from '@syncfusion/ej2-calendars';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { Tooltip } from '@syncfusion/ej2-popups';\nMultiSelect.Inject(CheckBoxSelection);\nvar Columns = /** @class */ (function (_super) {\n    __extends(Columns, _super);\n    function Columns() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"field\", void 0);\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"label\", void 0);\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"type\", void 0);\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"values\", void 0);\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"operators\", void 0);\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"template\", void 0);\n    __decorate([\n        Property({ isRequired: true, min: 0, max: Number.MAX_VALUE })\n    ], Columns.prototype, \"validation\", void 0);\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"format\", void 0);\n    __decorate([\n        Property(null)\n    ], Columns.prototype, \"step\", void 0);\n    return Columns;\n}(ChildProperty));\nexport { Columns };\nvar Rules = /** @class */ (function (_super) {\n    __extends(Rules, _super);\n    function Rules() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Rules.prototype, \"condition\", void 0);\n    __decorate([\n        Property()\n    ], Rules.prototype, \"rules\", void 0);\n    __decorate([\n        Property(null)\n    ], Rules.prototype, \"field\", void 0);\n    __decorate([\n        Property(null)\n    ], Rules.prototype, \"label\", void 0);\n    __decorate([\n        Property(null)\n    ], Rules.prototype, \"type\", void 0);\n    __decorate([\n        Property(null)\n    ], Rules.prototype, \"operator\", void 0);\n    __decorate([\n        Property(null)\n    ], Rules.prototype, \"value\", void 0);\n    return Rules;\n}(ChildProperty));\nexport { Rules };\nvar Rule = /** @class */ (function (_super) {\n    __extends(Rule, _super);\n    function Rule() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('and')\n    ], Rule.prototype, \"condition\", void 0);\n    __decorate([\n        Property()\n    ], Rule.prototype, \"rules\", void 0);\n    return Rule;\n}(ChildProperty));\nexport { Rule };\nvar ShowButtons = /** @class */ (function (_super) {\n    __extends(ShowButtons, _super);\n    function ShowButtons() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(true)\n    ], ShowButtons.prototype, \"ruleDelete\", void 0);\n    __decorate([\n        Property(true)\n    ], ShowButtons.prototype, \"groupInsert\", void 0);\n    __decorate([\n        Property(true)\n    ], ShowButtons.prototype, \"groupDelete\", void 0);\n    return ShowButtons;\n}(ChildProperty));\nexport { ShowButtons };\nvar QueryBuilder = /** @class */ (function (_super) {\n    __extends(QueryBuilder, _super);\n    function QueryBuilder(options, element) {\n        return _super.call(this, options, element) || this;\n    }\n    QueryBuilder.prototype.getPersistData = function () {\n        return this.addOnPersist(['rule']);\n    };\n    /**\n     * Clears the rules without root rule.\n     * @returns void.\n     */\n    QueryBuilder.prototype.reset = function () {\n        this.isImportRules = false;\n        var bodeElem = this.element.querySelector('.e-group-body');\n        bodeElem.innerHTML = '';\n        bodeElem.appendChild(this.createElement('div', { attrs: { class: 'e-rule-list' } }));\n        this.levelColl[this.element.id + '_e_group0'] = [0];\n        this.rule = { condition: 'and', rules: [] };\n    };\n    QueryBuilder.prototype.getWrapper = function () {\n        return this.element;\n    };\n    QueryBuilder.prototype.getModuleName = function () {\n        return 'query-builder';\n    };\n    QueryBuilder.prototype.initialize = function () {\n        if (this.dataColl.length) {\n            var columnKeys = Object.keys(this.dataColl[0]);\n            var cols = [];\n            var type = void 0;\n            var isDate = false;\n            var value = void 0;\n            var validateObj = { isRequired: true, min: 0, max: Number.MAX_VALUE };\n            if (this.columns.length) {\n                this.columnSort();\n                var columns = this.columns;\n                for (var i = 0, len = columns.length; i < len; i++) {\n                    if (!columns[i].type) {\n                        if (columnKeys.indexOf(columns[i].field) > -1) {\n                            value = this.dataColl[0][columns[i].field];\n                            type = typeof value;\n                            if (type === 'string') {\n                                isDate = !isNaN(Date.parse(value));\n                            }\n                            else if (type === 'object') {\n                                isDate = value instanceof Date && !isNaN(value.getTime());\n                                type = 'string';\n                            }\n                            columns[i].type = type;\n                            isDate = false;\n                        }\n                        type = 'string';\n                    }\n                    if (!columns[i].validation) {\n                        columns[i].validation = validateObj;\n                    }\n                }\n            }\n            else {\n                for (var i = 0, len = columnKeys.length; i < len; i++) {\n                    value = this.dataColl[0][columnKeys[i]];\n                    type = typeof value;\n                    if (type === 'string') {\n                        isDate = !isNaN(Date.parse(value));\n                    }\n                    else if (type === 'object') {\n                        isDate = value instanceof Date && !isNaN(value.getTime());\n                        type = 'string';\n                    }\n                    cols[i] = { 'field': columnKeys[i], 'label': columnKeys[i], 'type': isDate ? 'date' : type,\n                        'validation': validateObj };\n                    isDate = false;\n                }\n                this.columns = cols;\n            }\n        }\n    };\n    QueryBuilder.prototype.clickEventHandler = function (event) {\n        var target = event.target;\n        this.isImportRules = false;\n        if (target.tagName === 'SPAN') {\n            target = target.parentElement;\n        }\n        if (target.className.indexOf('e-collapse-rule') > -1) {\n            var animation = new Animation({ duration: 1000, delay: 0 });\n            var summaryElem = document.getElementById(this.element.id + '_summary_content');\n            var txtareaElem = summaryElem.querySelector('.e-summary-text');\n            animation.animate('.e-query-builder', { name: 'SlideLeftIn' });\n            var groupElem = this.element.querySelector('.e-group-container');\n            groupElem.style.display = 'none';\n            txtareaElem.textContent = this.getSqlFromRules(this.rule);\n            summaryElem.style.display = 'block';\n            txtareaElem.style.height = txtareaElem.scrollHeight + 'px';\n        }\n        if (target.tagName === 'BUTTON') {\n            if (target.className.indexOf('e-removerule') > -1) {\n                if (target.className.indexOf('e-tooltip') > -1) {\n                    getComponent(target, 'tooltip').destroy();\n                }\n                this.deleteRule(target);\n            }\n            else if (target.className.indexOf('e-deletegroup') > -1) {\n                getComponent(target, 'tooltip').destroy();\n                this.deleteGroup(closest(target, '.e-group-container'));\n            }\n            else if (target.className.indexOf('e-edit-rule') > -1) {\n                var animation = new Animation({ duration: 1000, delay: 0 });\n                animation.animate('.e-query-builder', { name: 'SlideLeftIn' });\n                document.getElementById(this.element.id + '_summary_content').style.display = 'none';\n                if (this.element.querySelectorAll('.e-group-container').length < 1) {\n                    this.addGroupElement(false, this.element, this.rule.condition);\n                    var mRules = extend({}, this.rule, {}, true);\n                    this.setGroupRules(mRules);\n                    this.renderSummaryCollapse();\n                }\n                else {\n                    var groupElem = this.element.querySelector('.e-group-container');\n                    if (groupElem.querySelectorAll('.e-collapse-rule').length < 1) {\n                        this.renderSummaryCollapse();\n                    }\n                    groupElem.style.display = 'block';\n                }\n            }\n        }\n        else if (target.tagName === 'LABEL' && target.parentElement.className.indexOf('e-btn-group') > -1) {\n            var element = closest(target, '.e-group-container');\n            var args = { groupID: element.id, selectedItem: target, cancel: false };\n            this.trigger('beforeConditionChange', args);\n            var rule = this.getGroup(element);\n            rule.condition = target.textContent.toLowerCase();\n            args = { groupID: element.id, selectedItem: target };\n            this.trigger('conditionChanged', args);\n        }\n    };\n    QueryBuilder.prototype.selectBtn = function (target, event) {\n        if (event.name === 'beforeOpen') {\n            if (this.showButtons.groupInsert) {\n                removeClass([event.element.querySelector('li span.e-addgroup').parentElement], 'e-button-hide');\n            }\n            else {\n                addClass([event.element.querySelector('li span.e-addgroup').parentElement], 'e-button-hide');\n            }\n        }\n        else if (event.element.children[0].className.indexOf('e-addrule') > -1) {\n            this.addRuleElement(closest(target, '.e-group-container'), {});\n        }\n        else if (event.element.children[0].className.indexOf('e-addgroup') > -1) {\n            this.addGroupElement(true, closest(target, '.e-group-container'), '', true);\n        }\n    };\n    QueryBuilder.prototype.addRuleElement = function (target, rule) {\n        var ruleElem = this.ruleElem.cloneNode(true);\n        if (this.displayMode === 'Vertical' || this.element.className.indexOf('e-device') > -1) {\n            ruleElem.className = 'e-rule-container e-vertical-mode';\n        }\n        else {\n            ruleElem.className = 'e-rule-container e-horizontal-mode';\n        }\n        var groupLevel;\n        var rules;\n        var i;\n        var len;\n        var dropDownList;\n        var ruleListElem = target.querySelector('.e-rule-list');\n        var element = ruleElem.querySelector('button');\n        var height;\n        if (this.element.className.indexOf('e-device') > -1 || this.displayMode === 'Vertical') {\n            element.textContent = this.l10n.getConstant('Remove');\n            addClass([element], 'e-flat');\n            addClass([element], 'e-primary');\n        }\n        else {\n            addClass([element], 'e-round');\n            addClass([element], 'e-icon-btn');\n            var tooltip = new Tooltip({ content: this.l10n.getConstant('DeleteRule') });\n            tooltip.appendTo(element);\n            element = this.createElement('span', { attrs: { class: 'e-btn-icon e-icons e-delete-icon' } });\n            ruleElem.querySelector('button').appendChild(element);\n        }\n        ruleElem.setAttribute('id', target.id + '_e_rule' + this.ruleIdCounter);\n        this.ruleIdCounter++;\n        ruleElem.querySelector('.e-filter-input').setAttribute('id', ruleElem.id + '_filterkey');\n        ruleListElem.appendChild(ruleElem);\n        if (ruleElem.previousElementSibling && ruleElem.previousElementSibling.className.indexOf('e-rule-container') > -1) {\n            if (ruleElem.className.indexOf('e-joined-rule') < 0) {\n                ruleElem.className += ' e-joined-rule';\n            }\n            if (ruleElem.previousElementSibling.className.indexOf('e-prev-joined-rule') < 0) {\n                ruleElem.previousElementSibling.className += ' e-prev-joined-rule';\n            }\n        }\n        if (ruleElem.previousElementSibling && ruleElem.previousElementSibling.className.indexOf('e-group-container') > -1 &&\n            ruleElem.className.indexOf('e-separate-rule') < 0) {\n            ruleElem.className += ' e-separate-rule';\n        }\n        height = (this.element.className.indexOf('e-device') > -1) ? '250px' : '200px';\n        dropDownList = new DropDownList({\n            dataSource: this.columns,\n            fields: { text: 'label', value: 'field' },\n            placeholder: this.l10n.getConstant('SelectField'),\n            popupHeight: ((this.columns.length > 5) ? height : 'auto'),\n            change: this.changeField.bind(this),\n            value: rule ? rule.field : null\n        });\n        dropDownList.appendTo('#' + ruleElem.id + '_filterkey');\n        this.filterIndex = dropDownList.index;\n        groupLevel = this.levelColl[target.id];\n        if (!this.isImportRules) {\n            rules = this.rule;\n            for (i = 0, len = groupLevel.length; i < len; i++) {\n                rules = this.findGroupByIdx(groupLevel[i], rules, i === 0);\n            }\n            if (Object.keys(rule).length) {\n                rules.rules.push({\n                    'field': rule.field, 'type': rule.type, 'label': rule.label, 'operator': rule.operator, value: rule.value\n                });\n            }\n            else {\n                rules.rules.push({ 'field': '', 'type': '', 'label': '', 'operator': '', 'value': '' });\n            }\n        }\n        if (Object.keys(rule).length) {\n            this.changeRule(rule, {\n                element: dropDownList.element,\n                itemData: this.columns[this.filterIndex]\n            });\n        }\n    };\n    QueryBuilder.prototype.renderToolTip = function (element) {\n        var tooltip = new Tooltip({ content: this.l10n.getConstant('ValidationMessage'),\n            position: 'BottomCenter', cssClass: 'e-querybuilder-error' });\n        tooltip.appendTo(element);\n        tooltip.open(element);\n    };\n    /**\n     * Validate the conditions and it display errors for invalid fields.\n     * @returns boolean.\n     */\n    QueryBuilder.prototype.validateFields = function () {\n        var isValid = true;\n        if (this.allowValidation) {\n            var i = void 0;\n            var len = void 0;\n            var fieldElem = void 0;\n            var indexElem = void 0;\n            var valArray = [];\n            var groupElem = void 0;\n            var index = void 0;\n            var dropDownObj = void 0;\n            var tempElem = void 0;\n            var rule = void 0;\n            var ruleElemCln = this.element.querySelectorAll('.e-rule-container');\n            var validateRule = void 0;\n            for (i = 0, len = ruleElemCln.length; i < len; i++) {\n                groupElem = closest(ruleElemCln[i], '.e-group-container');\n                rule = this.getGroup(groupElem);\n                index = 0;\n                indexElem = tempElem = ruleElemCln[i];\n                dropDownObj = getComponent(ruleElemCln[i].querySelector('.e-rule-field input.e-control'), 'dropdownlist');\n                validateRule = !isNullOrUndefined(dropDownObj.index) && this.columns[dropDownObj.index].validation;\n                fieldElem = tempElem.querySelector('.e-rule-field input.e-control');\n                if (validateRule && validateRule.isRequired) {\n                    while (indexElem && indexElem.previousElementSibling !== null) {\n                        indexElem = indexElem.previousElementSibling;\n                        index++;\n                    }\n                    fieldElem = tempElem.querySelector('.e-rule-field input.e-control');\n                    if (!rule.rules[index].field) {\n                        if (fieldElem.parentElement.className.indexOf('e-tooltip') < 0) {\n                            this.renderToolTip(fieldElem.parentElement);\n                        }\n                        isValid = false;\n                    }\n                    fieldElem = tempElem.querySelector('.e-rule-operator input.e-control');\n                    if (!rule.rules[index].operator) {\n                        if (fieldElem.parentElement.className.indexOf('e-tooltip') < 0) {\n                            this.renderToolTip(fieldElem.parentElement);\n                        }\n                        isValid = false;\n                    }\n                    if (rule.rules[index].value instanceof Array) {\n                        valArray = rule.rules[index].value;\n                    }\n                    if (isNullOrUndefined(rule.rules[index].value) || rule.rules[index].value === ''\n                        || (rule.rules[index].value instanceof Array && valArray.length < 1)) {\n                        var valElem = tempElem.querySelectorAll('.e-rule-value input.e-control');\n                        isValid = false;\n                        var j = 0;\n                        for (var j_1 = 0, jLen = valElem.length; j_1 < jLen; j_1++) {\n                            var element = valElem[j_1];\n                            var elem = void 0;\n                            if (element.parentElement.className.indexOf('e-searcher') > -1) {\n                                elem = closest(element, '.e-multi-select-wrapper');\n                                if (elem.className.indexOf('e-tooltip') < 0) {\n                                    this.renderToolTip(elem);\n                                }\n                            }\n                            else if (valElem[j_1].parentElement.className.indexOf('e-tooltip') < 0) {\n                                this.renderToolTip(valElem[j_1].parentElement);\n                            }\n                            j_1++;\n                        }\n                    }\n                }\n                else if (dropDownObj.element && isNullOrUndefined(dropDownObj.index)) {\n                    if (fieldElem.parentElement.className.indexOf('e-tooltip') < 0) {\n                        this.renderToolTip(fieldElem.parentElement);\n                    }\n                    isValid = false;\n                }\n            }\n        }\n        return isValid;\n    };\n    QueryBuilder.prototype.groupTemplate = function () {\n        var groupElem;\n        var grpBodyElem;\n        var groupHdrElem;\n        var rulesElem;\n        var glueElem;\n        var inputElem;\n        var labelElem;\n        var grpActElem;\n        var groupBtn;\n        groupElem = this.createElement('div', { attrs: { class: 'e-group-container' } });\n        groupHdrElem = this.createElement('div', { attrs: { class: 'e-group-header' } });\n        grpBodyElem = this.createElement('div', { attrs: { class: 'e-group-body' } });\n        rulesElem = this.createElement('div', { attrs: { class: 'e-rule-list' } });\n        groupElem.appendChild(groupHdrElem);\n        grpBodyElem.appendChild(rulesElem);\n        groupElem.appendChild(grpBodyElem);\n        // create button group in OR and AND process\n        glueElem = this.createElement('div', { attrs: { class: 'e-btn-group' } });\n        inputElem = this.createElement('input', { attrs: { type: 'radio', class: 'e-btngroup-and', value: 'AND' } });\n        inputElem.setAttribute('checked', 'true');\n        glueElem.appendChild(inputElem);\n        labelElem = this.createElement('label', { attrs: { class: 'e-btn e-btngroup-and-lbl e-small' }, innerHTML: 'AND' });\n        glueElem.appendChild(labelElem);\n        inputElem = this.createElement('input', { attrs: { type: 'radio', class: 'e-btngroup-or', value: 'OR' } });\n        glueElem.appendChild(inputElem);\n        labelElem = this.createElement('label', { attrs: { class: 'e-btn e-btngroup-or-lbl e-small' }, innerHTML: 'OR' });\n        glueElem.appendChild(labelElem);\n        groupHdrElem.appendChild(glueElem);\n        grpActElem = this.createElement('div', { attrs: { class: 'e-group-action' } });\n        groupBtn = this.createElement('button', { attrs: { type: 'button', class: 'e-add-btn' } });\n        grpActElem.appendChild(groupBtn);\n        groupHdrElem.appendChild(grpActElem);\n        return groupElem;\n    };\n    QueryBuilder.prototype.ruleTemplate = function () {\n        var ruleElem;\n        var filterElem;\n        var tempElem;\n        var delBtnElem;\n        var fieldElem;\n        var clsName;\n        ruleElem = this.createElement('div');\n        fieldElem = this.createElement('div', { attrs: { class: 'e-rule-field' } });\n        tempElem = this.createElement('div', { attrs: { class: 'e-rule-filter' } });\n        filterElem = this.createElement('input', { attrs: { type: 'text', class: 'e-filter-input' } });\n        tempElem.appendChild(filterElem);\n        fieldElem.appendChild(tempElem);\n        tempElem = this.createElement('div', { attrs: { class: 'e-rule-operator' } });\n        fieldElem.appendChild(tempElem);\n        tempElem = this.createElement('div', { attrs: { class: 'e-rule-value' } });\n        fieldElem.appendChild(tempElem);\n        tempElem = this.createElement('div', { attrs: { class: 'e-rule-value-delete' } });\n        if (this.showButtons.ruleDelete) {\n            clsName = 'e-removerule e-rule-delete e-css e-btn e-small';\n        }\n        else {\n            clsName = 'e-removerule e-rule-delete e-css e-btn e-small e-button-hide';\n        }\n        delBtnElem = this.createElement('button', { attrs: { class: clsName } });\n        tempElem.appendChild(delBtnElem);\n        fieldElem.appendChild(tempElem);\n        ruleElem.appendChild(fieldElem);\n        return ruleElem;\n    };\n    QueryBuilder.prototype.addGroupElement = function (isGroup, target, condition, isBtnClick) {\n        if (this.element.querySelectorAll('.e-group-container').length >= this.maxGroupCount) {\n            return;\n        }\n        var dltGroupBtn;\n        var groupElem = this.groupElem.cloneNode(true);\n        groupElem.setAttribute('id', this.element.id + '_e_group' + this.groupIdCounter);\n        this.groupIdCounter++;\n        var andInpElem = groupElem.querySelector('.e-btngroup-and');\n        var orInpElem = groupElem.querySelector('.e-btngroup-or');\n        var andLblElem = groupElem.querySelector('.e-btngroup-and-lbl');\n        var orLblElem = groupElem.querySelector('.e-btngroup-or-lbl');\n        andInpElem.setAttribute('id', this.element.id + '_and' + this.btnGroupId);\n        orInpElem.setAttribute('id', this.element.id + '_or' + this.btnGroupId);\n        andInpElem.setAttribute('name', this.element.id + '_and' + this.btnGroupId);\n        orInpElem.setAttribute('name', this.element.id + '_and' + this.btnGroupId);\n        andLblElem.setAttribute('for', this.element.id + '_and' + this.btnGroupId);\n        orLblElem.setAttribute('for', this.element.id + '_or' + this.btnGroupId);\n        this.btnGroupId++;\n        if (isGroup) {\n            var clsName = this.showButtons.groupDelete ? 'e-deletegroup' : 'e-deletegroup e-button-hide';\n            dltGroupBtn = this.createElement('button', { attrs: { class: clsName } });\n            var button = new Button({ iconCss: 'e-icons e-delete-icon', cssClass: 'e-small e-round' });\n            button.appendTo(dltGroupBtn);\n            var tooltip = new Tooltip({ content: this.l10n.getConstant('DeleteGroup') });\n            tooltip.appendTo(dltGroupBtn);\n            rippleEffect(dltGroupBtn, { selector: '.deletegroup' });\n            groupElem.querySelector('.e-group-action').appendChild(dltGroupBtn);\n            var ruleList = target.querySelector('.e-rule-list');\n            var grpLen = target.querySelectorAll('.e-group-container').length;\n            ruleList.appendChild(groupElem);\n            var level = this.levelColl[target.id].slice(0);\n            level.push(grpLen);\n            this.levelColl[groupElem.id] = level;\n            if (!this.isImportRules) {\n                this.addGroups([], target.id);\n                if (isBtnClick) {\n                    this.addRuleElement(groupElem, {});\n                }\n            }\n        }\n        else {\n            target.appendChild(groupElem);\n            this.levelColl[groupElem.id] = [0];\n        }\n        groupElem.querySelector('.e-btngroup-and').setAttribute('checked', 'true');\n        if (condition === 'or') {\n            groupElem.querySelector('.e-btngroup-or').setAttribute('checked', 'true');\n        }\n        var groupBtn = groupElem.querySelector('.e-add-btn');\n        var btnObj = new DropDownButton({\n            items: this.items,\n            cssClass: 'e-round e-small e-caret-hide e-addrulegroup',\n            iconCss: 'e-icons e-add-icon',\n            beforeOpen: this.selectBtn.bind(this, groupBtn),\n            select: this.selectBtn.bind(this, groupBtn)\n        });\n        btnObj.appendTo(groupBtn);\n        rippleEffect(groupBtn, { selector: '.e-round' });\n    };\n    QueryBuilder.prototype.notifyChange = function (value, element) {\n        var tempColl = closest(element, '.e-rule-value').querySelectorAll('.e-template');\n        var valueColl = [];\n        for (var i = 0, iLen = tempColl.length; i < iLen; i++) {\n            if (tempColl[i].nextElementSibling) {\n                if (tempColl[i].nextElementSibling.className.indexOf('e-check') > -1) {\n                    valueColl.push(tempColl[i].textContent);\n                }\n            }\n        }\n        this.updateRules(element, (tempColl.length > 1) ? valueColl : value);\n    };\n    QueryBuilder.prototype.changeValue = function (i, args) {\n        var eventsArgs;\n        var element;\n        if (args.event) {\n            element = args.event.target;\n        }\n        else {\n            var multiSelectArgs = args;\n            element = multiSelectArgs.element;\n        }\n        if (element.className.indexOf('e-day') > -1) {\n            var calenderArgs = args;\n            element = calenderArgs.element;\n        }\n        var groupElem = closest(element, '.e-group-container');\n        var ruleElem = closest(element, '.e-rule-container');\n        var dateElement = args;\n        if (dateElement.element && dateElement.element.className.indexOf('e-datepicker') > -1) {\n            element = dateElement.element;\n        }\n        var value;\n        if (element.className.indexOf('e-radio') > -1) {\n            value = getComponent(element, 'radio').label;\n        }\n        else if (element.className.indexOf('e-multiselect') > -1) {\n            value = getComponent(element, 'multiselect').value;\n        }\n        else {\n            value = args.value;\n        }\n        eventsArgs = { groupID: groupElem.id, ruleID: ruleElem.id, value: value, cancel: false };\n        this.trigger('beforeValueChange', eventsArgs);\n        this.updateRules(element, value, i);\n        eventsArgs = { groupID: groupElem.id, ruleID: ruleElem.id, value: value, cancel: false };\n        this.trigger('valueChanged', eventsArgs);\n    };\n    QueryBuilder.prototype.changeField = function (args) {\n        if (args.isInteracted) {\n            var groupElem = closest(args.element, '.e-group-container');\n            var rules = this.getGroup(groupElem);\n            var ruleElem = closest(args.element, '.e-rule-container');\n            var index = 0;\n            while (ruleElem && ruleElem.previousElementSibling !== null) {\n                ruleElem = ruleElem.previousElementSibling;\n                index++;\n            }\n            this.changeRule(rules.rules[index], args);\n        }\n    };\n    QueryBuilder.prototype.changeRule = function (rule, args) {\n        if (!args.itemData) {\n            return;\n        }\n        var tempRule = {};\n        var ddlObj;\n        var inOperator = ['in', 'notin'];\n        var operatorList;\n        var betweenOperator = ['between', 'notbetween'];\n        var filterElem;\n        var operatorElem;\n        var oprElem;\n        var prevOper = rule.operator ? rule.operator.toLowerCase() : '';\n        filterElem = closest(args.element, '.e-rule-filter');\n        operatorElem = closest(args.element, '.e-rule-operator');\n        var dropDownObj = getComponent(args.element, 'dropdownlist');\n        var element = closest(args.element, '.e-group-container');\n        if (filterElem) {\n            var ruleElem = closest(filterElem, '.e-rule-container');\n            var eventsArgs = {\n                groupID: element.id, ruleID: ruleElem.id, selectedItem: args.item, cancel: false\n            };\n            this.trigger('beforeFieldChange', eventsArgs);\n            tempRule.type = this.columns[dropDownObj.index].type;\n            if (ruleElem.querySelector('.e-template')) {\n                rule.value = '';\n            }\n        }\n        if (operatorElem) {\n            var ruleElem = closest(operatorElem, '.e-rule-container');\n            var eventsArgs = {\n                groupID: element.id, ruleID: ruleElem.id, selectedItem: args.item, cancel: false\n            };\n            this.trigger('beforeOperatorChange', eventsArgs);\n            tempRule.operator = args.itemData.value;\n            var currOper = tempRule.operator.toLowerCase();\n            if (inOperator.indexOf(currOper) > -1 || betweenOperator.indexOf(currOper) > -1) {\n                filterElem = operatorElem.previousElementSibling;\n                tempRule.type = rule.type;\n                if (!(inOperator.indexOf(currOper) > -1 && inOperator.indexOf(prevOper) > -1) &&\n                    !(betweenOperator.indexOf(currOper) > -1 && betweenOperator.indexOf(prevOper) > -1)) {\n                    rule.value = [];\n                }\n            }\n            else if (typeof rule.value === 'object') {\n                rule.value = rule.value.length > 0 ? rule.value[0] : '';\n            }\n            if (args.previousItemData) {\n                var prevValue = args.previousItemData.value.toLowerCase();\n                if (prevValue.indexOf('between') > -1 || (prevValue.indexOf('in') > -1 && prevValue.indexOf('contains') < 0)) {\n                    filterElem = operatorElem.previousElementSibling;\n                    tempRule.type = rule.type;\n                }\n            }\n            if ((inOperator.indexOf(currOper) > -1 && inOperator.indexOf(prevOper) > -1) ||\n                (betweenOperator.indexOf(currOper) > -1 && betweenOperator.indexOf(prevOper) > -1)) {\n                filterElem = null;\n            }\n        }\n        if (filterElem) {\n            operatorElem = filterElem.nextElementSibling;\n            addClass([operatorElem], 'e-operator');\n            if (operatorElem.childElementCount) {\n                ddlObj = getComponent(operatorElem.querySelector('.e-dropdownlist'), 'dropdownlist');\n                tempRule.operator = ddlObj.value;\n                this.renderValues(operatorElem, args.itemData, args.previousItemData, true, rule, tempRule, args.element);\n            }\n            else {\n                var ruleId = closest(operatorElem, '.e-rule-container').id;\n                oprElem = this.createElement('input', { attrs: { type: 'text', id: ruleId + '_operatorkey' } });\n                operatorElem.appendChild(oprElem);\n                if (this.columns[dropDownObj.index].operators) {\n                    operatorList = this.columns[dropDownObj.index].operators;\n                }\n                else if (args.itemData) {\n                    operatorList = this.customOperators[this.columns[dropDownObj.index].type + 'Operator'];\n                }\n                var height = (this.element.className.indexOf('e-device') > -1) ? '250px' : '200px';\n                var dropDownList = new DropDownList({\n                    dataSource: operatorList,\n                    fields: { text: 'key', value: 'value' },\n                    placeholder: this.l10n.getConstant('SelectOperator'),\n                    popupHeight: ((operatorList.length > 5) ? height : 'auto'),\n                    change: this.changeField.bind(this),\n                    index: 0,\n                    value: rule ? rule.operator : null\n                });\n                dropDownList.appendTo('#' + ruleId + '_operatorkey');\n                tempRule.operator = (rule && rule.operator !== '') ? rule.operator : operatorList[0].value;\n                if (this.isImportRules) {\n                    tempRule.type = this.columns[dropDownObj.index].type;\n                    tempRule.operator = rule.operator;\n                }\n                this.renderValues(operatorElem, this.columns[dropDownObj.index], args.previousItemData, false, rule, tempRule, args.element);\n            }\n        }\n        if (!this.isImportRules) {\n            this.updateRules(args.element, args.item);\n        }\n    };\n    // tslint:disable-next-line:no-any\n    QueryBuilder.prototype.destroyControls = function (target) {\n        var inputElement;\n        inputElement = target.nextElementSibling.querySelectorAll('input.e-control');\n        var divElement;\n        divElement = target.nextElementSibling.querySelectorAll('div.e-control:not(.e-handle)');\n        var columns = this.columns;\n        for (var i = 0, len = inputElement.length; i < len; i++) {\n            if (inputElement[i].classList.contains('e-textbox')) {\n                getComponent(inputElement[i], 'textbox').destroy();\n                detach(target.nextElementSibling.querySelector('input#' + inputElement[i].id));\n            }\n            else if (inputElement[i].classList.contains('e-dropdownlist')) {\n                getComponent(inputElement[i], 'dropdownlist').destroy();\n            }\n            else if (inputElement[i].classList.contains('e-radio')) {\n                getComponent(inputElement[i], 'radio').destroy();\n            }\n            else if (inputElement[i].classList.contains('e-numerictextbox')) {\n                getComponent(inputElement[i], 'numerictextbox').destroy();\n                detach(target.nextElementSibling.querySelector('input#' + inputElement[i].id));\n            }\n            else if (inputElement[i].classList.contains('e-datepicker')) {\n                getComponent(inputElement[i], 'datepicker').destroy();\n            }\n            else if (inputElement[i].classList.contains('e-multiselect')) {\n                getComponent(inputElement[i], 'multiselect').destroy();\n            }\n            else if (inputElement[i].className.indexOf('e-template') > -1) {\n                var clsName = inputElement[i].className;\n                for (var j = 0, jLen = columns.length; j < jLen; j++) {\n                    if (columns[j].template && clsName.indexOf(columns[j].field) > -1) {\n                        this.templateDestroy(columns[j], inputElement[i].id);\n                        break;\n                    }\n                }\n            }\n            if (document.getElementById(inputElement[i].id)) {\n                detach(inputElement[i]);\n            }\n        }\n        for (var i = 0, len = divElement.length; i < len; i++) {\n            if (divElement[i].className.indexOf('e-template') > -1) {\n                var clsName = divElement[i].className;\n                for (var j = 0, jLen = columns.length; j < jLen; j++) {\n                    if (columns[j].template && clsName.indexOf(columns[j].field) > -1) {\n                        this.templateDestroy(columns[j], divElement[i].id);\n                        break;\n                    }\n                }\n            }\n            detach(divElement[i]);\n        }\n    };\n    QueryBuilder.prototype.templateDestroy = function (column, elemId) {\n        var temp = column.template.destroy;\n        if (column.template && column.template.destroy) {\n            if (typeof temp === 'string') {\n                temp = getValue(temp, window);\n                temp({ elementId: elemId });\n            }\n            else {\n                column.template.destroy({ elementId: elemId });\n            }\n        }\n    };\n    QueryBuilder.prototype.getDistinctValues = function (dataSource, field) {\n        var original = {};\n        var result = [];\n        for (var i = 0, iLen = dataSource.length; i < iLen; i++) {\n            var value = dataSource[i][field];\n            if (Number(dataSource[i][field]) === dataSource[i][field] && dataSource[i][field] % 1 !== 0) {\n                value = dataSource[i][field].toString();\n            }\n            var data = {};\n            if (!(value in original)) {\n                original[value] = 1;\n                data[field] = value;\n                result.push(data);\n            }\n        }\n        return result;\n    };\n    QueryBuilder.prototype.renderMultiSelect = function (rule, parentId, i, selectedValue) {\n        var ds = this.getDistinctValues(this.dataColl, rule.field);\n        var multiSelectObj = new MultiSelect({\n            dataSource: new DataManager(ds),\n            query: new Query([rule.field]),\n            fields: { text: rule.field, value: rule.field },\n            value: selectedValue,\n            mode: 'CheckBox',\n            width: '100%',\n            change: this.changeValue.bind(this, i)\n        });\n        multiSelectObj.appendTo('#' + parentId + '_valuekey' + i);\n    };\n    QueryBuilder.prototype.processTemplate = function (target, itemData, rule, tempRule) {\n        var tempElements = closest(target, '.e-rule-container').querySelectorAll('.e-template');\n        if (tempElements.length < 2) {\n            if (itemData.template && typeof itemData.template.write === 'string') {\n                getValue(itemData.template.write, window)({ elements: tempElements[0], values: rule.value, operator: tempRule.operator });\n            }\n            else if (itemData.template && itemData.template.write) {\n                itemData.template.write({ elements: tempElements[0], values: rule.value, operator: tempRule.operator });\n            }\n        }\n        else {\n            if (itemData.template && typeof itemData.template.write === 'string') {\n                getValue(itemData.template.write, window)({ elements: tempElements, values: rule.value, operator: tempRule.operator });\n            }\n            else if (itemData.template && itemData.template.write) {\n                itemData.template.write({ elements: tempElements, values: rule.value, operator: tempRule.operator });\n            }\n        }\n    };\n    QueryBuilder.prototype.renderStringValue = function (parentId, rule, operator, idx, ruleValElem) {\n        var selectedVal;\n        var selectedValue = this.isImportRules ? rule.value : '';\n        if ((operator === 'in' || operator === 'notin') && this.dataColl.length) {\n            selectedVal = this.isImportRules ? rule.value : [];\n            this.renderMultiSelect(rule, parentId, idx, selectedVal);\n            if (this.displayMode === 'Vertical' || this.element.className.indexOf('e-device') > -1) {\n                ruleValElem.style.width = '100%';\n            }\n            else {\n                ruleValElem.style.width = null;\n                ruleValElem.style.minWidth = '200px';\n            }\n        }\n        else {\n            if (operator === 'in' || operator === 'notin') {\n                selectedVal = this.isImportRules ? rule.value : [];\n                selectedValue = selectedVal.join(',');\n            }\n            var inputobj = new TextBox({\n                placeholder: 'Value',\n                input: this.changeValue.bind(this, idx)\n            });\n            inputobj.appendTo('#' + parentId + '_valuekey' + idx);\n            inputobj.value = selectedValue;\n            inputobj.dataBind();\n        }\n    };\n    QueryBuilder.prototype.renderNumberValue = function (parentId, rule, operator, idx, ruleValElem, itemData, length) {\n        var selectedValue = this.isImportRules ? rule.value : 0;\n        var selectedVal;\n        if ((operator === 'in' || operator === 'notin') && this.dataColl.length) {\n            selectedVal = this.isImportRules ? rule.value : [];\n            this.renderMultiSelect(rule, parentId, idx, selectedVal);\n            if (this.element.className.indexOf('e-device') > -1 || this.displayMode === 'Vertical') {\n                ruleValElem.style.width = '100%';\n            }\n            else {\n                ruleValElem.style.minWidth = '200px';\n                ruleValElem.style.width = null;\n            }\n        }\n        else if (operator === 'in' || operator === 'notin') {\n            selectedVal = this.isImportRules ? rule.value : [];\n            var selVal = selectedVal.join(',');\n            var inputobj = new TextBox({\n                placeholder: 'Value',\n                input: this.changeValue.bind(this, idx)\n            });\n            inputobj.appendTo('#' + parentId + '_valuekey' + idx);\n            inputobj.value = selVal;\n            inputobj.dataBind();\n        }\n        else {\n            var fieldObj = getComponent(document.getElementById(parentId + '_filterkey'), 'dropdownlist');\n            itemData = this.columns[fieldObj.index];\n            var min = (itemData.validation && itemData.validation.min) ? itemData.validation.min : 0;\n            var max = (itemData.validation && itemData.validation.max) ? itemData.validation.max : Number.MAX_VALUE;\n            var format = itemData.format ? itemData.format : '#';\n            if (length > 1 && rule) {\n                selectedValue = rule.value[idx] ? rule.value[idx] : 0;\n            }\n            var numeric = new NumericTextBox({\n                value: selectedValue,\n                format: format, min: min, max: max, width: '100%',\n                step: itemData.step ? itemData.step : 1,\n                change: this.changeValue.bind(this, idx)\n            });\n            numeric.appendTo('#' + parentId + '_valuekey' + idx);\n        }\n    };\n    QueryBuilder.prototype.processValueString = function (value, type) {\n        var numArr = [];\n        var strArr = value.split(',');\n        if (type === 'string') {\n            return strArr;\n        }\n        else {\n            for (var k = 0, kLen = strArr.length; k < kLen; k++) {\n                numArr.push(Number(strArr[k]));\n            }\n            return numArr;\n        }\n    };\n    QueryBuilder.prototype.renderControls = function (target, itemData, rule, tempRule) {\n        addClass([target.parentElement.querySelector('.e-rule-value')], 'e-value');\n        if (itemData.template) {\n            this.processTemplate(target, itemData, rule, tempRule);\n        }\n        else {\n            var length_1 = (tempRule.type === 'boolean' ||\n                tempRule.operator && tempRule.operator.toLowerCase().indexOf('between') > -1) ? 2 : 1;\n            var parentId = closest(target, '.e-rule-container').id;\n            var ruleValElem = void 0;\n            if (target.className.indexOf('e-rule-operator') > -1 || target.className.indexOf('e-rule-filter') > -1) {\n                ruleValElem = target.parentElement.querySelector('.e-rule-value');\n                if (this.element.className.indexOf('e-device') > -1 || this.displayMode === 'Vertical') {\n                    ruleValElem.style.width = '100%';\n                }\n                else {\n                    if (tempRule.operator !== 'in' && tempRule.operator !== 'notin') {\n                        ruleValElem.style.width = '200px';\n                    }\n                }\n                for (var i = 0; i < length_1; i++) {\n                    switch (tempRule.type) {\n                        case 'string':\n                            {\n                                this.renderStringValue(parentId, rule, tempRule.operator, i, ruleValElem);\n                            }\n                            break;\n                        case 'number':\n                            {\n                                this.renderNumberValue(parentId, rule, tempRule.operator, i, ruleValElem, itemData, length_1);\n                            }\n                            break;\n                        case 'boolean':\n                            {\n                                var values = itemData.values && itemData.values.length ? itemData.values : ['True', 'False'];\n                                var isCheck = this.isImportRules ? Boolean(rule.value) : true;\n                                var radiobutton = new RadioButton({\n                                    label: values[i], name: parentId + 'default', checked: isCheck,\n                                    change: this.changeValue.bind(this, i)\n                                });\n                                radiobutton.appendTo('#' + parentId + '_valuekey' + i);\n                            }\n                            break;\n                        case 'date':\n                            {\n                                var selectedValue = new Date();\n                                var selVal = void 0;\n                                if (this.isImportRules && rule && rule.value) {\n                                    selectedValue = (length_1 > 1) ? new Date(rule.value[i]) : new Date(rule.value);\n                                    var format_1 = void 0;\n                                    var column = this.getColumn(rule.field);\n                                    selVal = (length_1 > 1) ? rule.value[i] : rule.value;\n                                    format_1 = { type: 'dateTime', format: column.format || 'MM/dd/yyyy' };\n                                    selectedValue = this.intl.parseDate(selVal, format_1);\n                                }\n                                var format = itemData.format ? itemData.format : 'MM/dd/yyyy';\n                                var datepick = new DatePicker({\n                                    value: selectedValue, format: format,\n                                    change: this.changeValue.bind(this, i)\n                                });\n                                datepick.appendTo('#' + parentId + '_valuekey' + i);\n                            }\n                            break;\n                    }\n                }\n            }\n        }\n    };\n    QueryBuilder.prototype.renderValues = function (target, itemData, prevItemData, isRender, rule, tempRule, element) {\n        if (isRender) {\n            var ddlObj = getComponent(target.querySelector('input'), 'dropdownlist');\n            if (itemData.operators) {\n                ddlObj.dataSource = itemData.operators;\n                ddlObj.index = ddlObj.index !== 0 ? 0 : 1;\n                ddlObj.dataBind();\n                tempRule.operator = ddlObj.value;\n            }\n            else if (itemData.type) {\n                ddlObj.dataSource = this.customOperators[itemData.type + 'Operator'];\n                ddlObj.index = ddlObj.index !== 0 ? 0 : 1;\n                ddlObj.dataBind();\n                tempRule.operator = ddlObj.value;\n            }\n        }\n        var parentId = closest(target, '.e-rule-container').id;\n        if (prevItemData && prevItemData.template) {\n            this.templateDestroy(prevItemData, parentId + '_valuekey0');\n            detach(target.nextElementSibling.querySelector('#' + parentId + '_valuekey0'));\n        }\n        if (isRender) {\n            this.destroyControls(target);\n        }\n        var filtElem = document.getElementById(element.id.replace('operatorkey', 'filterkey'));\n        var filtObj = getComponent(filtElem, 'dropdownlist');\n        itemData.template = this.columns[filtObj.index].template;\n        if (itemData.template) {\n            itemData.template = this.columns[filtObj.index].template;\n            var valElem = void 0;\n            if (itemData.template && typeof itemData.template.create === 'string') {\n                valElem = getValue(itemData.template.create, window)();\n            }\n            else if (itemData.template && itemData.template.create) {\n                valElem = itemData.template.create();\n            }\n            if (valElem instanceof Element) {\n                valElem.id = parentId + '_valuekey0';\n                addClass([valElem], 'e-template');\n                addClass([valElem], 'e-' + itemData.field);\n                target.nextElementSibling.appendChild(valElem);\n            }\n            else if (valElem instanceof Array) {\n                addClass(valElem, 'e-template');\n                for (var i = 0, iLen = valElem.length; i < iLen; i++) {\n                    valElem[i].id = parentId + '_valuekey' + i;\n                    target.nextElementSibling.appendChild(valElem[i]);\n                }\n            }\n            var parentElem = target.parentElement.querySelector('.e-rule-value');\n            if (this.element.className.indexOf('e-device') > -1 || this.displayMode === 'Vertical') {\n                parentElem.style.width = '100%';\n            }\n            else {\n                parentElem.style.minWidth = '200px';\n            }\n        }\n        else {\n            if (tempRule.type === 'boolean' || tempRule.operator && tempRule.operator.toLowerCase().indexOf('between') > -1) {\n                for (var i = 0; i < 2; i++) {\n                    var valElem = void 0;\n                    valElem = this.createElement('input', { attrs: { type: 'text', id: parentId + '_valuekey' + i } });\n                    target.nextElementSibling.appendChild(valElem);\n                }\n            }\n            else {\n                var valElem = this.createElement('input', { attrs: { type: 'text', id: parentId + '_valuekey0' } });\n                target.nextElementSibling.appendChild(valElem);\n            }\n        }\n        this.renderControls(target, itemData, rule, tempRule);\n    };\n    QueryBuilder.prototype.updateValues = function (element, rule) {\n        var controlName = element.className.split(' e-')[1];\n        var i = parseInt(element.id.slice(-1), 2);\n        switch (controlName) {\n            case 'textbox':\n                rule.value = getComponent(element, controlName).value;\n                break;\n            case 'dropdownlist':\n                rule.value = getComponent(element, controlName).value;\n                break;\n            case 'radio':\n                rule.value = getComponent(element, controlName).value;\n                break;\n            case 'numerictextbox':\n                if (rule.operator.indexOf('between') > -1) {\n                    rule.value[i] = getComponent(element, controlName).value;\n                }\n                else {\n                    rule.value = getComponent(element, controlName).value;\n                }\n                break;\n            case 'datepicker':\n                var column = this.getColumn(rule.field);\n                var format = { type: 'dateTime', format: column.format || 'MM/dd/yyyy' };\n                if (rule.operator.indexOf('between') > -1) {\n                    rule.value[i] = getComponent(element, controlName).value;\n                }\n                else {\n                    rule.value = this.intl.formatDate(getComponent(element, controlName).value, format);\n                }\n                break;\n        }\n    };\n    QueryBuilder.prototype.updateRules = function (target, selectedValue, i) {\n        var groupElem = closest(target, '.e-group-container');\n        var rule = this.getGroup(groupElem);\n        var ruleElem = closest(target, '.e-rule-container');\n        var index = 0;\n        var dropDownObj;\n        var eventsArgs;\n        while (ruleElem && ruleElem.previousElementSibling !== null) {\n            ruleElem = ruleElem.previousElementSibling;\n            index++;\n        }\n        ruleElem = closest(target, '.e-rule-container');\n        if (closest(target, '.e-rule-filter')) {\n            dropDownObj = getComponent(target, 'dropdownlist');\n            rule.rules[index].field = this.columns[dropDownObj.index].field;\n            rule.rules[index].type = this.columns[dropDownObj.index].type;\n            rule.rules[index].label = this.columns[dropDownObj.index].label;\n            var ruleElement = closest(target, '.e-rule-filter');\n            var element = ruleElement.nextElementSibling.querySelector('input.e-control');\n            var operator = getComponent(element, 'dropdownlist').value;\n            rule.rules[index].operator = operator;\n            element = ruleElement.nextElementSibling.nextElementSibling.querySelector('input.e-control');\n            if (!element) {\n                element = ruleElement.nextElementSibling.nextElementSibling.querySelector('div.e-control');\n            }\n            eventsArgs = { groupID: groupElem.id, ruleID: ruleElem.id, selectedItem: selectedValue, cancel: false };\n            this.updateValues(element, rule.rules[index]);\n            this.trigger('fieldChanged', eventsArgs);\n            if (this.allowValidation && rule.rules[index].field && target.parentElement.className.indexOf('e-tooltip') > -1) {\n                getComponent(target.parentElement, 'tooltip').destroy();\n            }\n        }\n        else if (closest(target, '.e-rule-operator')) {\n            dropDownObj = getComponent(target, 'dropdownlist');\n            rule.rules[index].operator = dropDownObj.value;\n            var inputElem = void 0;\n            var parentElem = target.parentElement;\n            inputElem = ruleElem.querySelectorAll('.e-rule-value input.e-control');\n            eventsArgs = { groupID: groupElem.id, ruleID: ruleElem.id, selectedItem: selectedValue, cancel: false };\n            if (this.allowValidation && rule.rules[index].operator && target.parentElement.className.indexOf('e-tooltip') > -1) {\n                getComponent(target.parentElement, 'tooltip').destroy();\n            }\n            if (inputElem.length > 1) {\n                rule.rules[index].value = [];\n            }\n            for (var i_1 = 0; i_1 < inputElem.length; i_1++) {\n                this.updateValues(inputElem[i_1], rule.rules[index]);\n            }\n            this.trigger('operatorChanged', eventsArgs);\n        }\n        else if (closest(target, '.e-rule-value')) {\n            this.ruleValueUpdate(target, selectedValue, rule, index, groupElem, ruleElem, i);\n        }\n    };\n    QueryBuilder.prototype.ruleValueUpdate = function (target, selectedValue, rule, index, groupElem, ruleElem, i) {\n        var eventsArgs;\n        var arrOperator = ['in', 'between'];\n        if (selectedValue !== null) {\n            var oper = rule.rules[index].operator.toLowerCase();\n            if (target.className.indexOf('e-multiselect') > -1 && rule.rules[index].type === 'number') {\n                var selVal = [];\n                var dupSelectedValue = selectedValue;\n                for (var k = 0, kLen = dupSelectedValue.length; k < kLen; k++) {\n                    if (typeof dupSelectedValue[k] === 'string') {\n                        selVal.push(parseFloat(dupSelectedValue[k]));\n                    }\n                }\n                if (selVal.length) {\n                    selectedValue = selVal;\n                }\n            }\n            if (target.className.indexOf('e-template') > -1) {\n                if (selectedValue instanceof Array) {\n                    if (arrOperator.indexOf(oper) > -1) {\n                        rule.rules[index].value = selectedValue;\n                    }\n                    else {\n                        rule.rules[index].value = selectedValue[0];\n                    }\n                }\n                else {\n                    rule.rules[index].value = selectedValue;\n                }\n                eventsArgs = { groupID: groupElem.id, ruleID: ruleElem.id, selectedItem: selectedValue, cancel: false };\n                this.trigger('valueChanged', eventsArgs);\n            }\n            else if (target.className.indexOf('e-spin') > -1 || target.className.indexOf('e-numeric') > -1) {\n                if (arrOperator.indexOf(oper) > -1) {\n                    rule.rules[index].value[i] = selectedValue;\n                }\n                else {\n                    rule.rules[index].value = selectedValue;\n                }\n            }\n            else if (target.className.indexOf('e-radio') > -1) {\n                rule.rules[index].value = selectedValue;\n            }\n            else if (target.className.indexOf('e-multiselect') > -1) {\n                rule.rules[index].value = selectedValue;\n            }\n            else if (target.className.indexOf('e-textbox') > -1) {\n                if (oper === 'in' || oper === 'notin') {\n                    if (rule.rules[index].type === 'string') {\n                        rule.rules[index].value = this.processValueString(selectedValue, rule.rules[index].type);\n                    }\n                    else {\n                        rule.rules[index].value = this.processValueString(selectedValue, rule.rules[index].type);\n                    }\n                }\n                else {\n                    rule.rules[index].value = selectedValue;\n                }\n            }\n            else if (target.className.indexOf('e-datepicker') > -1) {\n                var ddlInst = getInstance(ruleElem.querySelector('.e-rule-filter input'), DropDownList);\n                var format = { type: 'dateTime', format: this.columns[ddlInst.index].format || 'MM/dd/yyyy' };\n                if (format.type) {\n                    if (arrOperator.indexOf(oper) > -1) {\n                        rule.rules[index].value[i] = this.intl.formatDate(selectedValue, format);\n                    }\n                    else {\n                        rule.rules[index].value = this.intl.formatDate(selectedValue, format);\n                    }\n                }\n            }\n            this.validatValue(rule, index, ruleElem);\n        }\n    };\n    QueryBuilder.prototype.validatValue = function (rule, index, ruleElem) {\n        if (this.allowValidation && rule.rules[index].value) {\n            var valElem = ruleElem.querySelectorAll('.e-rule-value .e-control');\n            if (valElem[0].className.indexOf('e-tooltip') > -1) {\n                getComponent(valElem[0], 'tooltip').destroy();\n            }\n            else if (valElem[0].parentElement.className.indexOf('e-tooltip') > -1) {\n                getComponent(valElem[0].parentElement, 'tooltip').destroy();\n            }\n            if (valElem[1] && valElem[1].parentElement.className.indexOf('e-tooltip') > -1) {\n                getComponent(valElem[1].parentElement, 'tooltip').destroy();\n            }\n        }\n    };\n    QueryBuilder.prototype.findGroupByIdx = function (groupIdx, rule, isRoot) {\n        var ruleColl = rule.rules;\n        if (!isRoot && ruleColl[groupIdx]) {\n            rule = ruleColl[groupIdx];\n            if (rule.rules) {\n                return rule;\n            }\n            else {\n                for (var j = groupIdx + 1, jLen = ruleColl.length; j < jLen; j++) {\n                    rule = ruleColl[j];\n                    if (rule.rules) {\n                        return rule;\n                    }\n                }\n            }\n        }\n        return rule;\n    };\n    /**\n     * Removes the component from the DOM and detaches all its related event handlers.\n     * Also it maintains the initial input element from the DOM.\n     * @method destroy\n     * @return {void}\n     */\n    QueryBuilder.prototype.destroy = function () {\n        var queryElement = this.element;\n        if (!queryElement) {\n            return;\n        }\n        var element;\n        var i;\n        var len;\n        _super.prototype.destroy.call(this);\n        element = this.element.querySelectorAll('.e-addrulegroup');\n        len = element.length;\n        for (i = 0; i < len; i++) {\n            getComponent(element[i], 'dropdown-btn').destroy();\n            detach(element[i]);\n        }\n        element = this.element.querySelectorAll('.e-rule-filter .e-control');\n        len = element.length;\n        for (i = 0; i < len; i++) {\n            getComponent(element[i], 'dropdownlist').destroy();\n            detach(element[i]);\n        }\n        element = this.element.querySelectorAll('.e-rule-operator .e-control');\n        len = element.length;\n        for (i = 0; i < len; i++) {\n            getComponent(element[i], 'dropdownlist').destroy();\n            detach(element[i]);\n        }\n        this.isImportRules = false;\n        this.unWireEvents();\n        this.levelColl[this.element.id + '_e_group0'] = [0];\n        this.rule = { condition: 'and', rules: [] };\n        this.element.innerHTML = '';\n        classList(this.element, [], ['e-rtl', 'e-responsive', 'e-device']);\n    };\n    /**\n     * Adds single or multiple rules.\n     * @returns void.\n     */\n    QueryBuilder.prototype.addRules = function (rule, groupID) {\n        var args = { groupID: groupID };\n        for (var i = 0, len = rule.length; i < len; i++) {\n            this.addRuleElement(document.getElementById(groupID), rule[i]);\n        }\n        this.trigger('ruleInsert', args);\n    };\n    /**\n     * Adds single or multiple groups, which contains the collection of rules.\n     * @returns void.\n     */\n    QueryBuilder.prototype.addGroups = function (groups, groupID) {\n        var groupElem = document.getElementById(groupID);\n        var rule = this.getGroup(groupElem);\n        var grouplen = groups.length;\n        var args = { groupID: groupID };\n        if (grouplen) {\n            for (var i = 0, len = groups.length; i < len; i++) {\n                this.importRules(groups[i], groupElem);\n            }\n        }\n        else {\n            rule.rules.push({ 'condition': 'and', rules: [] });\n        }\n        this.trigger('groupInsert', args);\n    };\n    QueryBuilder.prototype.initWrapper = function () {\n        if (this.cssClass) {\n            addClass([this.element], this.cssClass);\n        }\n        if (this.enableRtl) {\n            addClass([this.element], 'e-rtl');\n        }\n        if (this.width) {\n            this.element.style.width = this.width;\n        }\n        if (this.height) {\n            this.element.style.height = this.height;\n        }\n        if (this.rule.rules.length) {\n            this.isImportRules = true;\n        }\n        else {\n            this.addGroupElement(false, this.element);\n        }\n        if (Browser.isDevice || this.displayMode === 'Vertical') {\n            if (Browser.isDevice) {\n                this.element.style.width = '100%';\n                this.element.classList.add('e-device');\n            }\n            removeClass(document.querySelectorAll('.e-rule-container'), 'e-horizontal-mode');\n            addClass(document.querySelectorAll('.e-rule-container'), 'e-vertical-mode');\n            this.displayMode = 'Vertical';\n        }\n        else {\n            this.displayMode = 'Horizontal';\n        }\n        if (this.isImportRules && this.summaryView) {\n            this.renderSummary();\n        }\n        else {\n            if (this.columns.length && this.isImportRules) {\n                this.addGroupElement(false, this.element, this.rule.condition);\n                var mRules = extend({}, this.rule, {}, true);\n                this.setGroupRules(mRules);\n            }\n            else if (this.columns.length) {\n                this.addRuleElement(this.element.querySelector('.e-group-container'), {});\n            }\n            var buttons = document.querySelectorAll('label.e-btn');\n            var button = void 0;\n            for (var i = 0; i < buttons.length; i++) {\n                button = buttons.item(i);\n                rippleEffect(button, { selector: '.e-btn' });\n            }\n        }\n    };\n    QueryBuilder.prototype.renderSummary = function () {\n        var contentElem = this.createElement('div', {\n            attrs: {\n                class: 'e-summary-content',\n                id: this.element.id + '_summary_content'\n            }\n        });\n        var textElem = this.createElement('textarea', { attrs: { class: 'e-summary-text', readonly: 'true' }, styles: 'max-height:500px' });\n        var editElem = this.createElement('button', { attrs: { class: 'e-edit-rule e-css e-btn e-small e-flat e-primary' } });\n        var divElem = this.createElement('div', { attrs: { class: 'e-summary-btndiv' } });\n        contentElem.appendChild(textElem);\n        textElem.textContent = this.getSqlFromRules(this.rule);\n        editElem.textContent = this.l10n.getConstant('Edit');\n        divElem.appendChild(editElem);\n        contentElem.appendChild(divElem);\n        this.element.appendChild(contentElem);\n    };\n    QueryBuilder.prototype.renderSummaryCollapse = function () {\n        var collapseElem = this.createElement('div', {\n            attrs: {\n                class: 'e-collapse-rule e-icons',\n                title: this.l10n.getConstant('SummaryViewTitle')\n            }\n        });\n        this.element.querySelector('.e-group-header').appendChild(collapseElem);\n    };\n    QueryBuilder.prototype.columnSort = function () {\n        if (this.sortDirection.toLowerCase() === 'descending') {\n            this.columns = new DataManager(this.columns).executeLocal(new Query().sortByDesc('field'));\n        }\n        else if (this.sortDirection.toLowerCase() === 'ascending') {\n            this.columns = new DataManager(this.columns).executeLocal(new Query().sortBy('field'));\n        }\n    };\n    QueryBuilder.prototype.onPropertyChanged = function (newProp, oldProp) {\n        var properties = Object.keys(newProp);\n        for (var _i = 0, properties_1 = properties; _i < properties_1.length; _i++) {\n            var prop = properties_1[_i];\n            switch (prop) {\n                case 'summaryView':\n                    var groupElem = this.element.querySelector('.e-group-container');\n                    var summaryElem = this.element.querySelector('.e-summary-content');\n                    if (newProp.summaryView) {\n                        groupElem.style.display = 'none';\n                        if (this.element.querySelectorAll('.e-summary-content').length < 1) {\n                            this.renderSummary();\n                            summaryElem = this.element.querySelector('.e-summary-content');\n                        }\n                        else {\n                            this.element.querySelector('.e-summary-text').textContent = this.getSqlFromRules(this.rule);\n                        }\n                        summaryElem.style.display = 'block';\n                    }\n                    else {\n                        if (groupElem.querySelectorAll('.e-collapse-rule').length > -1) {\n                            this.renderSummaryCollapse();\n                        }\n                        groupElem.style.display = 'block';\n                        summaryElem.style.display = 'none';\n                    }\n                    break;\n                case 'displayMode':\n                    if (newProp.displayMode === 'Horizontal') {\n                        addClass(this.element.querySelectorAll('.e-rule-container'), 'e-horizontal-mode');\n                        removeClass(this.element.querySelectorAll('.e-rule-container'), 'e-vertical-mode');\n                    }\n                    else {\n                        addClass(this.element.querySelectorAll('.e-rule-container'), 'e-vertical-mode');\n                        removeClass(this.element.querySelectorAll('.e-rule-container'), 'e-horizontal-mode');\n                    }\n                    break;\n                case 'showButtons':\n                    if (newProp.showButtons.ruleDelete) {\n                        removeClass(this.element.querySelectorAll('.e-rule-delete'), 'e-button-hide');\n                    }\n                    else {\n                        addClass(this.element.querySelectorAll('.e-rule-delete'), 'e-button-hide');\n                    }\n                    if (newProp.showButtons.groupDelete) {\n                        removeClass(this.element.querySelectorAll('.e-deletegroup'), 'e-button-hide');\n                    }\n                    else {\n                        addClass(this.element.querySelectorAll('.e-deletegroup'), 'e-button-hide');\n                    }\n                    break;\n                case 'cssClass':\n                    if (oldProp.cssClass) {\n                        removeClass([this.element], oldProp.cssClass.split(' '));\n                    }\n                    if (newProp.cssClass) {\n                        addClass([this.element], newProp.cssClass.split(' '));\n                    }\n                    break;\n                case 'enableRtl':\n                    if (newProp.enableRtl) {\n                        addClass([this.element], 'e-rtl');\n                    }\n                    else {\n                        removeClass([this.element], 'e-rtl');\n                    }\n                    break;\n                case 'enablePersistence':\n                    this.enablePersistence = newProp.enablePersistence;\n                    break;\n                case 'dataSource':\n                    this.dataSource = newProp.dataSource;\n                    break;\n                case 'columns':\n                    this.columns = newProp.columns;\n                    this.columnSort();\n                    break;\n                case 'sortDirection':\n                    this.sortDirection = newProp.sortDirection;\n                    this.columnSort();\n                    break;\n                case 'maxGroupCount':\n                    this.maxGroupCount = newProp.maxGroupCount;\n                    break;\n                case 'height':\n                    this.height = newProp.height;\n                    this.element.style.height = this.height;\n                    break;\n                case 'rule':\n                    this.rule = newProp.rule;\n                    break;\n                case 'width':\n                    this.width = newProp.width;\n                    this.element.style.width = this.width;\n                    break;\n                case 'locale':\n                    this.locale = newProp.locale;\n                    break;\n            }\n        }\n    };\n    QueryBuilder.prototype.preRender = function () {\n        this.defaultLocale = {\n            StartsWith: 'Starts With',\n            EndsWith: 'Ends With',\n            Contains: 'Contains',\n            Equal: 'Equal',\n            NotEqual: 'Not Equal',\n            LessThan: 'Less Than',\n            LessThanOrEqual: 'Less Than Or Equal',\n            GreaterThan: 'Greater Than',\n            GreaterThanOrEqual: 'Greater Than Or Equal',\n            Between: 'Between',\n            NotBetween: 'Not Between',\n            In: 'In',\n            NotIn: 'Not In',\n            Remove: 'REMOVE',\n            SelectField: 'Select a field',\n            SelectOperator: 'Select operator',\n            DeleteRule: 'Remove this condition',\n            DeleteGroup: 'Delete group',\n            AddGroup: 'Add Group',\n            AddCondition: 'Add Condition',\n            Edit: 'EDIT',\n            ValidationMessage: 'This field is required',\n            SummaryViewTitle: 'Summary View'\n        };\n        this.l10n = new L10n('querybuilder', this.defaultLocale, this.locale);\n        this.intl = new Internationalization();\n        this.groupIdCounter = 0;\n        this.ruleIdCounter = 0;\n        this.btnGroupId = 0;\n        this.isImportRules = false;\n        this.parser = [];\n        this.customOperators = {\n            stringOperator: [\n                { value: 'startswith', key: this.l10n.getConstant('StartsWith') },\n                { value: 'endswith', key: this.l10n.getConstant('EndsWith') },\n                { value: 'contains', key: this.l10n.getConstant('Contains') },\n                { value: 'equal', key: this.l10n.getConstant('Equal') },\n                { value: 'notequal', key: this.l10n.getConstant('NotEqual') },\n                { value: 'in', key: this.l10n.getConstant('In') },\n                { value: 'notin', key: this.l10n.getConstant('NotIn') }\n            ],\n            dateOperator: [\n                { value: 'equal', key: this.l10n.getConstant('Equal') },\n                { value: 'greaterthan', key: this.l10n.getConstant('GreaterThan') },\n                { value: 'greaterthanorequal', key: this.l10n.getConstant('GreaterThanOrEqual') },\n                { value: 'lessthan', key: this.l10n.getConstant('LessThan') },\n                { value: 'lessthanorequal', key: this.l10n.getConstant('LessThanOrEqual') },\n                { value: 'notequal', key: this.l10n.getConstant('NotEqual') }\n            ],\n            booleanOperator: [\n                { value: 'equal', key: this.l10n.getConstant('Equal') },\n                { value: 'notequal', key: this.l10n.getConstant('NotEqual') }\n            ],\n            numberOperator: [\n                { value: 'equal', key: this.l10n.getConstant('Equal') },\n                { value: 'greaterthanorequal', key: this.l10n.getConstant('GreaterThanOrEqual') },\n                { value: 'greaterthan', key: this.l10n.getConstant('GreaterThan') },\n                { value: 'between', key: this.l10n.getConstant('Between') },\n                { value: 'lessthan', key: this.l10n.getConstant('LessThan') },\n                { value: 'notbetween', key: this.l10n.getConstant('NotBetween') },\n                { value: 'lessthanorequal', key: this.l10n.getConstant('LessThanOrEqual') },\n                { value: 'notequal', key: this.l10n.getConstant('NotEqual') },\n                { value: 'in', key: this.l10n.getConstant('In') },\n                { value: 'notin', key: this.l10n.getConstant('NotIn') }\n            ],\n        };\n        this.operators = {\n            equal: '=', notequal: '!=', greaterthan: '>', greaterthanorequal: '>=', lessthan: '<', in: 'IN', notin: 'NOT IN',\n            lessthanorequal: '<=', startswith: 'LIKE', endswith: 'LIKE', between: 'BETWEEN', notbetween: 'NOT BETWEEN', contains: 'LIKE'\n        };\n        this.operatorValue = {\n            equal: 'Equal', greaterthan: 'GreaterThan', greaterthanorequal: 'GreaterThanOrEqual',\n            lessthan: 'LessThan', lessthanorequal: 'LessThanOrEqual', notequal: 'NotEqual',\n            between: 'Between', in: 'in', notin: 'NotIn', notbetween: 'NotBetween', startswith: 'StartsWith', endswith: 'EndsWith',\n            contains: 'Contains'\n        };\n    };\n    QueryBuilder.prototype.render = function () {\n        this.levelColl = {};\n        this.items = [\n            {\n                text: this.l10n.getConstant('AddGroup'),\n                iconCss: 'e-icons e-add-icon e-addgroup'\n            },\n            {\n                text: this.l10n.getConstant('AddCondition'),\n                iconCss: 'e-icons e-add-icon e-addrule',\n            }\n        ];\n        this.ruleElem = this.ruleTemplate();\n        this.groupElem = this.groupTemplate();\n        if (this.dataSource instanceof DataManager) {\n            this.dataManager = this.dataSource;\n            this.executeDataManager(new Query());\n        }\n        else {\n            this.dataManager = new DataManager(this.dataSource);\n            this.dataColl = this.dataManager.executeLocal(new Query());\n            this.initControl();\n        }\n    };\n    QueryBuilder.prototype.executeDataManager = function (query) {\n        var _this = this;\n        var data = this.dataManager.executeQuery(query);\n        var deferred = new Deferred();\n        data.then(function (e) {\n            _this.dataColl = e.result;\n            _this.initControl();\n        }).catch(function (e) {\n            deferred.reject(e);\n        });\n    };\n    QueryBuilder.prototype.initControl = function () {\n        this.initialize();\n        this.initWrapper();\n        this.wireEvents();\n    };\n    QueryBuilder.prototype.wireEvents = function () {\n        var wrapper = this.getWrapper();\n        EventHandler.add(wrapper, 'click', this.clickEventHandler, this);\n    };\n    QueryBuilder.prototype.unWireEvents = function () {\n        var wrapper = this.getWrapper();\n        EventHandler.remove(wrapper, 'click', this.clickEventHandler);\n    };\n    QueryBuilder.prototype.getGroup = function (target, isParent) {\n        var groupLevel = this.levelColl[target.id];\n        var len = isParent ? groupLevel.length - 1 : groupLevel.length;\n        var rule = this.rule;\n        for (var i = 0; i < len; i++) {\n            rule = this.findGroupByIdx(groupLevel[i], rule, i === 0);\n        }\n        return rule;\n    };\n    QueryBuilder.prototype.deleteGroup = function (target) {\n        var groupElem = target;\n        var groupId = groupElem.id;\n        var rule = this.getGroup(groupElem, true);\n        var index = 0;\n        var i;\n        var len;\n        var args = { groupID: groupId };\n        this.trigger('groupDelete', args);\n        var nextElem = groupElem.nextElementSibling;\n        var prevElem = groupElem.previousElementSibling;\n        var element = groupElem.querySelectorAll('.e-group-container');\n        var valElem = target.querySelectorAll('.e-tooltip');\n        len = valElem.length;\n        for (i = 0; i < len; i++) {\n            getComponent(valElem[i], 'tooltip').destroy();\n        }\n        for (i = 0, len = element.length; i < len; i++) {\n            delete this.levelColl[element[i].id];\n        }\n        while (groupElem.previousElementSibling !== null) {\n            groupElem = groupElem.previousElementSibling;\n            index++;\n        }\n        if (nextElem && nextElem.className.indexOf('e-separate-rule') > -1) {\n            removeClass([nextElem], 'e-separate-rule');\n            addClass([nextElem], 'e-joined-rule');\n            if (prevElem && prevElem.className.indexOf('e-rule-container') > -1) {\n                addClass([prevElem], 'e-prev-joined-rule');\n            }\n        }\n        rule.rules.splice(index, 1);\n        delete this.levelColl[groupId];\n        detach(target);\n    };\n    QueryBuilder.prototype.deleteRule = function (target) {\n        var groupElem = closest(target, '.e-group-container');\n        var rule = this.getGroup(groupElem);\n        var ruleElem = closest(target, '.e-rule-container');\n        var clnruleElem = ruleElem;\n        var nextElem = ruleElem.nextElementSibling;\n        var prevElem = ruleElem.previousElementSibling;\n        var args = { groupID: groupElem.id, ruleID: ruleElem.id };\n        var index = 0;\n        var valElem = ruleElem.querySelectorAll('.e-tooltip');\n        var i;\n        var len = valElem.length;\n        for (i = 0; i < len; i++) {\n            getComponent(valElem[i], 'tooltip').destroy();\n        }\n        while (ruleElem.previousElementSibling !== null) {\n            ruleElem = ruleElem.previousElementSibling;\n            index++;\n        }\n        rule.rules.splice(index, 1);\n        this.trigger('ruleDelete', args);\n        if (!prevElem || prevElem.className.indexOf('e-rule-container') < 0) {\n            if (nextElem) {\n                removeClass([nextElem], 'e-joined-rule');\n            }\n        }\n        if (!nextElem || nextElem.className.indexOf('e-rule-container') < 0) {\n            if (prevElem) {\n                removeClass([prevElem], 'e-prev-joined-rule');\n            }\n        }\n        detach(clnruleElem);\n    };\n    QueryBuilder.prototype.setGroupRules = function (rule) {\n        this.reset();\n        this.groupIdCounter = 1;\n        this.ruleIdCounter = 0;\n        this.isImportRules = true;\n        this.rule = rule;\n        this.importRules(this.rule, this.element.querySelector('.e-group-container'), true);\n        this.isImportRules = false;\n    };\n    /**\n     * Set the rule or rules collection.\n     * @returns void.\n     */\n    QueryBuilder.prototype.setRules = function (rule) {\n        var mRules = extend({}, rule, {}, true);\n        this.setGroupRules(mRules);\n    };\n    /**\n     * Gets the rule or rule collection.\n     * @returns object.\n     */\n    QueryBuilder.prototype.getRules = function () {\n        return this.rule;\n    };\n    /**\n     * Deletes the group or groups based on the group ID.\n     * @returns void.\n     */\n    QueryBuilder.prototype.deleteGroups = function (groupID) {\n        var i;\n        var len = groupID.length;\n        for (i = 0; i < len; i++) {\n            this.deleteGroup(document.getElementById(groupID[i]));\n        }\n    };\n    /**\n     * Gets the predicate from collection of rules.\n     * @returns object.\n     */\n    QueryBuilder.prototype.getFilteredRecords = function () {\n        var query = new Query().where(this.getPredicate(this.rule));\n        return new DataManager(this.dataSource).executeLocal(query);\n    };\n    /**\n     * Deletes the rule or rules based on the rule ID.\n     * @returns void.\n     */\n    QueryBuilder.prototype.deleteRules = function (ruleID) {\n        var i;\n        var len = ruleID.length;\n        for (i = 0; i < len; i++) {\n            this.deleteRule(document.getElementById(ruleID[i]));\n        }\n    };\n    /**\n     * Gets the query for Data Manager.\n     * @returns string.\n     */\n    QueryBuilder.prototype.getDataManagerQuery = function (rule) {\n        var predicate = this.getPredicate(rule);\n        var query;\n        var fields = [];\n        for (var i = 0, len = Object.keys(this.columns); i < len.length; i++) {\n            fields.push(this.columns[i].field);\n        }\n        if (rule.rules.length) {\n            query = new Query().select(fields).where(predicate);\n        }\n        else {\n            query = new Query().select(fields);\n        }\n        return query;\n    };\n    /**\n     * Get the predicate from collection of rules.\n     * @returns null\n     */\n    QueryBuilder.prototype.getPredicate = function (rule) {\n        var ruleColl = rule.rules;\n        var pred;\n        var pred2;\n        var date;\n        var ruleValue;\n        var matchCase = false;\n        var column;\n        for (var i = 0, len = ruleColl.length; i < len; i++) {\n            var keys = Object.keys(ruleColl[i]);\n            if (keys.indexOf('rules') > -1) {\n                pred2 = this.getPredicate(ruleColl[i]);\n                if (pred2) {\n                    if (pred) {\n                        if (rule.condition === 'and') {\n                            pred = pred.and(pred2);\n                        }\n                        else {\n                            pred = pred.or(pred2);\n                        }\n                    }\n                    else {\n                        pred = pred2;\n                    }\n                }\n            }\n            else if (ruleColl[i].operator.length) {\n                var oper = ruleColl[i].operator.toLowerCase();\n                var strOperColl = ['contains', 'startswith', 'endswith'];\n                var dateOperColl = ['equal', 'notequal'];\n                matchCase = (strOperColl.indexOf(oper) > -1 || (ruleColl[i].type === 'date' && dateOperColl.indexOf(oper) > -1));\n                column = this.getColumn(ruleColl[i].field);\n                if (ruleColl[i].type === 'date') {\n                    var format = { type: 'dateTime', format: column.format || 'MM/dd/yyyy' };\n                    ruleValue = this.intl.parseDate(ruleColl[i].value, format);\n                }\n                else {\n                    ruleValue = ruleColl[i].value;\n                }\n                if (i === 0) {\n                    if ((oper.indexOf('in') > -1 || oper.indexOf('between') > -1) && oper !== 'contains') {\n                        pred = this.arrayPredicate(ruleColl[i]);\n                    }\n                    else {\n                        var value = ruleValue;\n                        if (value !== '') {\n                            pred = new Predicate(ruleColl[i].field, ruleColl[i].operator, ruleValue, matchCase);\n                        }\n                    }\n                }\n                else {\n                    if (rule.condition === 'and') {\n                        if ((oper.indexOf('in') > -1 || oper.indexOf('between') > -1) && oper !== 'contains') {\n                            pred = this.arrayPredicate(ruleColl[i], pred, rule.condition);\n                        }\n                        else {\n                            var value = ruleValue;\n                            if (pred && value !== '') {\n                                pred = pred.and(ruleColl[i].field, ruleColl[i].operator, ruleValue, matchCase);\n                            }\n                            else if (value !== '') {\n                                pred = new Predicate(ruleColl[i].field, ruleColl[i].operator, ruleValue, matchCase);\n                            }\n                        }\n                    }\n                    else {\n                        if ((oper.indexOf('in') > -1 || oper.indexOf('between') > -1) && oper !== 'contains') {\n                            pred = this.arrayPredicate(ruleColl[i], pred, rule.condition);\n                        }\n                        else {\n                            var value = ruleValue;\n                            if (pred && value !== '') {\n                                pred = pred.or(ruleColl[i].field, ruleColl[i].operator, ruleValue, matchCase);\n                            }\n                            else if (value !== '') {\n                                pred = new Predicate(ruleColl[i].field, ruleColl[i].operator, ruleValue, matchCase);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return pred;\n    };\n    QueryBuilder.prototype.getColumn = function (field) {\n        var columns = this.columns;\n        var column;\n        for (var i = 0, iLen = columns.length; i < iLen; i++) {\n            if (columns[i].field === field) {\n                column = columns[i];\n            }\n        }\n        return column;\n    };\n    QueryBuilder.prototype.arrayPredicate = function (ruleColl, predicate, condition) {\n        var value = ruleColl.value;\n        var pred;\n        for (var j = 0, jLen = value.length; j < jLen; j++) {\n            if (value[j] !== '') {\n                if (j === 0) {\n                    switch (ruleColl.operator) {\n                        case 'between':\n                            pred = new Predicate(ruleColl.field, 'greaterthan', value[j]);\n                            break;\n                        case 'notbetween':\n                            pred = new Predicate(ruleColl.field, 'lessthan', value[j]);\n                            break;\n                        case 'in':\n                            pred = new Predicate(ruleColl.field, 'equal', value[j]);\n                            break;\n                        case 'notin':\n                            pred = new Predicate(ruleColl.field, 'notequal', value[j]);\n                            break;\n                    }\n                }\n                else {\n                    switch (ruleColl.operator) {\n                        case 'between':\n                            pred = pred.and(ruleColl.field, 'lessthan', value[j]);\n                            break;\n                        case 'notbetween':\n                            pred = pred.or(ruleColl.field, 'greaterthan', value[j]);\n                            break;\n                        case 'in':\n                            pred = pred.or(ruleColl.field, 'equal', value[j]);\n                            break;\n                        case 'notin':\n                            pred = pred.and(ruleColl.field, 'notequal', value[j]);\n                            break;\n                    }\n                }\n            }\n        }\n        if (pred) {\n            if (predicate) {\n                if (condition === 'and') {\n                    predicate = predicate.and(pred);\n                }\n                else if (condition === 'or') {\n                    predicate = predicate.or(pred);\n                }\n            }\n            else {\n                predicate = pred;\n            }\n        }\n        return predicate;\n    };\n    QueryBuilder.prototype.importRules = function (rule, parentElem, isReset) {\n        if (!isReset) {\n            parentElem = this.renderGroup(rule.condition, parentElem);\n        }\n        var ruleColl = rule.rules;\n        for (var i = 0, len = ruleColl.length; i < len; i++) {\n            var keys = Object.keys(ruleColl[i]);\n            if (keys.indexOf('rules') > -1) {\n                parentElem = this.renderGroup(ruleColl[i].condition, parentElem);\n                parentElem = this.importRules(ruleColl[i], parentElem, true);\n            }\n            else {\n                this.renderRule(ruleColl[i], parentElem);\n            }\n        }\n        parentElem = closest(parentElem, '.e-rule-list');\n        if (parentElem) {\n            parentElem = closest(parentElem, '.e-group-container');\n        }\n        return parentElem;\n    };\n    QueryBuilder.prototype.renderGroup = function (condition, parentElem) {\n        this.addGroupElement(true, parentElem, condition); //Child group\n        var element = parentElem.querySelectorAll('.e-group-container');\n        return element[element.length - 1];\n    };\n    QueryBuilder.prototype.renderRule = function (rule, parentElem) {\n        if (parentElem.className.indexOf('e-group-container') > -1) {\n            this.addRuleElement(parentElem, rule); //Create rule\n        }\n        else {\n            this.addRuleElement(parentElem.querySelector('.e-group-container'), rule); //Create group\n        }\n    };\n    QueryBuilder.prototype.getSqlString = function (rules, queryStr) {\n        var isRoot = false;\n        if (!queryStr) {\n            queryStr = '';\n            isRoot = true;\n        }\n        else {\n            queryStr += '(';\n        }\n        var condition = rules.condition;\n        for (var j = 0, jLen = rules.rules.length; j < jLen; j++) {\n            if (rules.rules[j].rules) {\n                queryStr = this.getSqlString(rules.rules[j], queryStr);\n            }\n            else {\n                var rule = rules.rules[j];\n                var valueStr = '';\n                if (rule.value instanceof Array) {\n                    if (typeof rule.value[0] === 'string') {\n                        valueStr += '(\"' + rule.value[0] + '\"';\n                        for (var k = 1, kLen = rule.value.length; k < kLen; k++) {\n                            valueStr += ',\"' + rule.value[k] + '\"';\n                        }\n                        valueStr += ')';\n                    }\n                    else {\n                        valueStr += '(' + rule.value + ')';\n                    }\n                }\n                else {\n                    if (rule.operator === 'startswith') {\n                        valueStr += '(\"' + rule.value + '%\")';\n                    }\n                    else if (rule.operator === 'endswith') {\n                        valueStr += '(\"%' + rule.value + '\")';\n                    }\n                    else if (rule.operator === 'contains') {\n                        valueStr += '(\"%' + rule.value + '%\")';\n                    }\n                    else {\n                        if (rule.type === 'number') {\n                            valueStr += rule.value;\n                        }\n                        else {\n                            valueStr += '\"' + rule.value + '\"';\n                        }\n                    }\n                }\n                queryStr += rule.field + ' ' + this.operators[rule.operator] + ' ' + valueStr;\n            }\n            if (j !== jLen - 1) {\n                queryStr += ' ' + condition + ' ';\n            }\n        }\n        if (!isRoot) {\n            queryStr += ')';\n        }\n        return queryStr;\n    };\n    /**\n     * Sets the rules from the sql query.\n     */\n    QueryBuilder.prototype.setRulesFromSql = function (sqlString) {\n        var ruleModel = this.getRulesFromSql(sqlString);\n        this.setRules({ condition: ruleModel.condition, rules: ruleModel.rules });\n    };\n    /**\n     * Get the rules from SQL query.\n     * @returns object.\n     */\n    QueryBuilder.prototype.getRulesFromSql = function (sqlString) {\n        this.parser = [];\n        this.sqlParser(sqlString);\n        this.rule = { condition: '', rules: [] };\n        return this.processParser(this.parser, this.rule, [0]);\n    };\n    /**\n     * Gets the sql query from rules.\n     * @returns object.\n     */\n    QueryBuilder.prototype.getSqlFromRules = function (rule) {\n        return this.getSqlString(rule).replace(/\"/g, '\\'');\n    };\n    QueryBuilder.prototype.sqlParser = function (sqlString) {\n        var st = 0;\n        var str;\n        do {\n            str = sqlString.slice(st);\n            st += this.parseSqlStrings(str);\n        } while (str !== '');\n        return this.parser;\n    };\n    QueryBuilder.prototype.parseSqlStrings = function (sqlString) {\n        var operators = ['=', '!=', '<', '>', '<=', '>='];\n        var conditions = ['and', 'or'];\n        var subOp = ['IN', 'NOT IN', 'LIKE', 'NOT LIKE', 'BETWEEN', 'NOT BETWEEN'];\n        var regexStr;\n        var regex;\n        var matchValue;\n        for (var i = 0, iLen = operators.length; i < iLen; i++) {\n            regexStr = /^\\w+$/.test(operators[i]) ? '\\\\b' : '';\n            regex = new RegExp('^(' + operators[i] + ')' + regexStr, 'ig');\n            if (regex.exec(sqlString)) {\n                this.parser.push(['Operators', operators[i].toLowerCase()]);\n                return operators[i].length;\n            }\n        }\n        for (var i = 0, iLen = conditions.length; i < iLen; i++) {\n            regexStr = /^\\w+$/.test(conditions[i]) ? '\\\\b' : '';\n            regex = new RegExp('^(' + conditions[i] + ')' + regexStr, 'ig');\n            if (regex.exec(sqlString)) {\n                this.parser.push(['Conditions', conditions[i].toLowerCase()]);\n                return conditions[i].length;\n            }\n        }\n        for (var i = 0, iLen = subOp.length; i < iLen; i++) {\n            regexStr = /^\\w+$/.test(subOp[i]) ? '\\\\b' : '';\n            regex = new RegExp('^(' + subOp[i] + ')' + regexStr, 'ig');\n            if (regex.exec(sqlString)) {\n                this.parser.push(['SubOperators', subOp[i].toLowerCase()]);\n                return subOp[i].length;\n            }\n        }\n        //Left Parenthesis\n        if (/^\\(/.exec(sqlString)) {\n            this.parser.push(['Left', '(']);\n            return 1;\n        }\n        //Right Parenthesis\n        if (/^\\)/.exec(sqlString)) {\n            this.parser.push(['Right', ')']);\n            return 1;\n        }\n        //Literals\n        if (/^`?([a-z_][a-z0-9_]{0,}(\\:(number|float|string|date|boolean))?)`?/i.exec(sqlString)) {\n            matchValue = /^`?([a-z_][a-z0-9_]{0,}(\\:(number|float|string|date|boolean))?)`?/i.exec(sqlString)[1];\n            this.parser.push(['Literal', matchValue]);\n            return matchValue.length;\n        }\n        //String\n        if (/^'((?:[^\\\\']+?|\\\\.|'')*)'(?!')/.exec(sqlString)) {\n            matchValue = /^'((?:[^\\\\']+?|\\\\.|'')*)'(?!')/.exec(sqlString)[0];\n            this.parser.push(['String', matchValue]);\n            return matchValue.length;\n        }\n        //Double String\n        if (/^\"([^\\\\\"]*(?:\\\\.[^\\\\\"]*)*)\"/.exec(sqlString)) {\n            matchValue = /^\"([^\\\\\"]*(?:\\\\.[^\\\\\"]*)*)\"/.exec(sqlString)[0];\n            this.parser.push(['DoubleString', matchValue]);\n            return matchValue.length;\n        }\n        //Number\n        if (/^[0-9]+(\\.[0-9]+)?/.exec(sqlString)) {\n            matchValue = /^[0-9]+(\\.[0-9]+)?/.exec(sqlString)[0];\n            this.parser.push(['Number', matchValue]);\n            return matchValue.length;\n        }\n        return 1;\n    };\n    QueryBuilder.prototype.getOperator = function (value, operator) {\n        var operators = {\n            '=': 'equal', '!=': 'notequal', '<': 'lessthan', '>': 'greaterthan', '<=': 'lessthanorequal',\n            '>=': 'greaterthanorequal', 'in': 'in', 'not in': 'notin', 'between': 'between', 'not between': 'notbetween'\n        };\n        if (value.indexOf('%') === 0 && value.indexOf('%') === value.length - 1) {\n            return 'contains';\n        }\n        else if (value.indexOf('%') === 0 && value.indexOf('%') !== value.length - 1) {\n            return 'startswith';\n        }\n        else if (value.indexOf('%') !== 0 && value.indexOf('%') === value.length - 1) {\n            return 'endswith';\n        }\n        return operators[operator];\n    };\n    QueryBuilder.prototype.processParser = function (parser, rules, levelColl) {\n        var rule;\n        var numVal = [];\n        var strVal = [];\n        var subRules;\n        var j;\n        var jLen;\n        var k;\n        var kLen;\n        var l;\n        var lLen;\n        var grpCount;\n        var operator;\n        for (var i = 0, iLen = parser.length; i < iLen; i++) {\n            if (parser[i][0] === 'Literal') {\n                rule = { label: parser[i][1], field: parser[i][1] };\n                if (parser[i + 1][0] === 'SubOperators') {\n                    rule.operator = this.getOperator(parser[i + 3][1].replace(/'/g, ''), parser[i + 1][1]);\n                    operator = parser[i + 1][1];\n                    i++;\n                    j = i + 1;\n                    jLen = iLen;\n                    for (j = i + 1; j < jLen; j++) {\n                        if (parser[j][0] === 'Right') {\n                            i = j;\n                            break;\n                        }\n                        else {\n                            if (operator === 'like' && parser[j][0] === 'String') {\n                                rule.value = parser[j][1].replace(/'/g, '').replace(/%/g, '');\n                                rule.type = 'string';\n                            }\n                            else {\n                                if (parser[j][0] === 'Number') {\n                                    numVal.push(Number(parser[j][1]));\n                                }\n                                else if (parser[j][0] === 'String') {\n                                    strVal.push(parser[j][1].replace(/'/g, ''));\n                                }\n                            }\n                        }\n                    }\n                    if (operator !== 'like') {\n                        if (parser[j - 1][0] === 'Number') {\n                            rule.value = numVal;\n                            rule.type = 'number';\n                        }\n                        else if (parser[j - 1][0] === 'String') {\n                            rule.value = strVal;\n                            rule.type = 'string';\n                        }\n                    }\n                }\n                else if (parser[i + 1][0] === 'Operators') {\n                    rule.operator = this.getOperator(parser[i + 2][1], parser[i + 1][1]);\n                    if (parser[i + 2][0] === 'Number') {\n                        rule.type = 'number';\n                        rule.value = Number(parser[i + 2][1]);\n                    }\n                    else {\n                        rule.type = 'string';\n                        rule.value = parser[i + 2][1].replace(/'/g, '');\n                    }\n                }\n                rules.rules.push(rule);\n            }\n            else if (parser[i][0] === 'Left') {\n                subRules = { condition: '', rules: [] };\n                this.parser = parser.splice(i + 1, iLen - (i + 1));\n                grpCount = 0;\n                //To get the group position\n                kLen = rules.rules.length;\n                for (k = 0; k < kLen; k++) {\n                    if (rules.rules[k].rules) {\n                        grpCount++;\n                    }\n                }\n                levelColl.push(grpCount);\n                rules.rules.push(subRules);\n                subRules = this.processParser(this.parser, subRules, levelColl);\n                return rules;\n            }\n            else if (parser[i][0] === 'Conditions') {\n                rules.condition = parser[i][1];\n            }\n            else if (parser[i][0] === 'Right') {\n                this.parser = parser.splice(i + 1, iLen - (i + 1));\n                //To get the parent Group\n                levelColl.pop();\n                rules = this.rule;\n                lLen = levelColl.length;\n                for (l = 0; l < lLen; l++) {\n                    rules = this.findGroupByIdx(levelColl[l], rules, l === 0);\n                }\n                return this.processParser(this.parser, rules, levelColl);\n            }\n        }\n        return rules;\n    };\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"beforeConditionChange\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"beforeFieldChange\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"beforeOperatorChange\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"beforeValueChange\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"conditionChanged\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"fieldChanged\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"valueChanged\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"operatorChanged\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"groupDelete\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"ruleDelete\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"groupInsert\", void 0);\n    __decorate([\n        Event()\n    ], QueryBuilder.prototype, \"ruleInsert\", void 0);\n    __decorate([\n        Property({ ruleDelete: true, groupInsert: true, groupDelete: true })\n    ], QueryBuilder.prototype, \"showButtons\", void 0);\n    __decorate([\n        Property(false)\n    ], QueryBuilder.prototype, \"summaryView\", void 0);\n    __decorate([\n        Property(false)\n    ], QueryBuilder.prototype, \"allowValidation\", void 0);\n    __decorate([\n        Property([])\n    ], QueryBuilder.prototype, \"columns\", void 0);\n    __decorate([\n        Property('')\n    ], QueryBuilder.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property([])\n    ], QueryBuilder.prototype, \"dataSource\", void 0);\n    __decorate([\n        Property('Horizontal')\n    ], QueryBuilder.prototype, \"displayMode\", void 0);\n    __decorate([\n        Property(false)\n    ], QueryBuilder.prototype, \"enableRtl\", void 0);\n    __decorate([\n        Property(false)\n    ], QueryBuilder.prototype, \"enablePersistence\", void 0);\n    __decorate([\n        Property('Default')\n    ], QueryBuilder.prototype, \"sortDirection\", void 0);\n    __decorate([\n        Property(5)\n    ], QueryBuilder.prototype, \"maxGroupCount\", void 0);\n    __decorate([\n        Property('auto')\n    ], QueryBuilder.prototype, \"height\", void 0);\n    __decorate([\n        Property('auto')\n    ], QueryBuilder.prototype, \"width\", void 0);\n    __decorate([\n        Complex({ condition: 'and', rules: [] }, Rule)\n    ], QueryBuilder.prototype, \"rule\", void 0);\n    QueryBuilder = __decorate([\n        NotifyPropertyChanges\n    ], QueryBuilder);\n    return QueryBuilder;\n}(Component));\nexport { QueryBuilder };\n"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","this","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","ej2Dropdowns","Inject","CheckBoxSelection","Columns","_super","apply","Property","isRequired","min","max","Number","MAX_VALUE","ChildProperty","Rules","Rule","ShowButtons","QueryBuilder","options","element","call","getPersistData","addOnPersist","reset","isImportRules","bodeElem","querySelector","innerHTML","appendChild","createElement","attrs","class","levelColl","id","rule","condition","rules","getWrapper","getModuleName","initialize","dataColl","columnKeys","keys","cols","type","isDate","value","validateObj","columns","columnSort","len","indexOf","field","isNaN","Date","parse","getTime","validation","label","clickEventHandler","event","tagName","parentElement","className","animation","Animation","duration","delay","summaryElem","document","getElementById","txtareaElem","animate","name","groupElem","style","display","textContent","getSqlFromRules","height","scrollHeight","getComponent","destroy","deleteRule","deleteGroup","closest","querySelectorAll","addGroupElement","mRules","extend","setGroupRules","renderSummaryCollapse","args","groupID","selectedItem","cancel","trigger","getGroup","toLowerCase","selectBtn","showButtons","groupInsert","removeClass","addClass","children","addRuleElement","ruleElem","cloneNode","displayMode","groupLevel","dropDownList","ruleListElem","l10n","getConstant","Tooltip","content","appendTo","setAttribute","ruleIdCounter","previousElementSibling","DropDownList","dataSource","fields","text","placeholder","popupHeight","change","changeField","bind","filterIndex","index","findGroupByIdx","push","operator","changeRule","itemData","renderToolTip","tooltip","position","cssClass","open","validateFields","isValid","allowValidation","fieldElem","indexElem","valArray","dropDownObj","tempElem","ruleElemCln","validateRule","isNullOrUndefined","valElem","j_1","jLen","elem","groupTemplate","grpBodyElem","groupHdrElem","rulesElem","glueElem","inputElem","labelElem","grpActElem","groupBtn","ruleTemplate","filterElem","delBtnElem","clsName","ruleDelete","isGroup","isBtnClick","maxGroupCount","dltGroupBtn","groupIdCounter","andInpElem","orInpElem","andLblElem","orLblElem","btnGroupId","groupDelete","Button","iconCss","rippleEffect","selector","ruleList","grpLen","level","slice","addGroups","DropDownButton","items","beforeOpen","select","notifyChange","tempColl","valueColl","iLen","nextElementSibling","updateRules","changeValue","eventsArgs","dateElement","ruleID","isInteracted","ddlObj","operatorList","operatorElem","oprElem","tempRule","inOperator","betweenOperator","prevOper","item","currOper","previousItemData","prevValue","childElementCount","renderValues","ruleId","operators","customOperators","destroyControls","inputElement","divElement","classList","contains","detach","j","template","templateDestroy","column","elemId","temp","getValue","window","elementId","getDistinctValues","original","result","toString","data","renderMultiSelect","parentId","selectedValue","ds","MultiSelect","DataManager","query","Query","mode","width","processTemplate","tempElements","write","elements","values","renderStringValue","idx","ruleValElem","selectedVal","join","inputobj","TextBox","input","dataBind","minWidth","renderNumberValue","selVal","fieldObj","format","NumericTextBox","step","processValueString","numArr","strArr","split","k","kLen","renderControls","length_1","isCheck","Boolean","RadioButton","checked","format_1","getColumn","intl","parseDate","DatePicker","prevItemData","isRender","filtElem","replace","filtObj","Element","parentElem","updateValues","controlName","parseInt","formatDate","ruleElement","i_1","ruleValueUpdate","arrOperator","oper","dupSelectedValue","parseFloat","ddlInst","getInstance","validatValue","groupIdx","isRoot","ruleColl","unWireEvents","addRules","groups","importRules","initWrapper","enableRtl","Browser","isDevice","add","summaryView","renderSummary","buttons","button","contentElem","textElem","readonly","styles","editElem","divElem","collapseElem","title","sortDirection","executeLocal","sortByDesc","sortBy","onPropertyChanged","newProp","oldProp","_i","properties_1","enablePersistence","locale","preRender","defaultLocale","StartsWith","EndsWith","Contains","Equal","NotEqual","LessThan","LessThanOrEqual","GreaterThan","GreaterThanOrEqual","Between","NotBetween","In","NotIn","Remove","SelectField","SelectOperator","DeleteRule","DeleteGroup","AddGroup","AddCondition","Edit","ValidationMessage","SummaryViewTitle","L10n","Internationalization","parser","stringOperator","dateOperator","booleanOperator","numberOperator","equal","notequal","greaterthan","greaterthanorequal","lessthan","in","notin","lessthanorequal","startswith","endswith","between","notbetween","operatorValue","render","dataManager","executeDataManager","initControl","_this","executeQuery","deferred","Deferred","then","e","catch","reject","wireEvents","wrapper","EventHandler","remove","isParent","groupId","nextElem","prevElem","splice","clnruleElem","setRules","getRules","deleteGroups","getFilteredRecords","where","getPredicate","deleteRules","getDataManagerQuery","predicate","pred","pred2","ruleValue","matchCase","and","or","dateOperColl","arrayPredicate","Predicate","isReset","renderGroup","renderRule","getSqlString","queryStr","valueStr","setRulesFromSql","sqlString","ruleModel","getRulesFromSql","sqlParser","processParser","str","st","parseSqlStrings","regexStr","matchValue","conditions","subOp","test","RegExp","exec","getOperator","=","!=","<",">","<=",">=","not in","not between","subRules","l","lLen","grpCount","numVal","strVal","pop","Event","Complex","NotifyPropertyChanges","Component"],"mappings":"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"}